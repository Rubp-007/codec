(this.webpackJsonpwebapp2=this.webpackJsonpwebapp2||[]).push([[0],{14:function(e,t,a){e.exports=a(24)},19:function(e,t,a){},20:function(e,t,a){},22:function(e,t,a){},23:function(e,t,a){},24:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),i=a(13),r=a.n(i),c=(a(19),a(2));a(20);function s(e){return l.a.createElement("header",{className:"app-header"},l.a.createElement("div",{className:"icons"},l.a.createElement("div",{className:"icon github"},l.a.createElement("a",{href:"https://github.com/pedrooaugusto/steganography-png",target:"_blank"},l.a.createElement("i",{className:"fa fa-github"})," Github")),l.a.createElement("div",{className:"icon medium"},l.a.createElement("a",{href:"#dois"},l.a.createElement("i",{className:"fa fa-medium"})," Article"))),l.a.createElement("div",{className:"main-title"},l.a.createElement("h1",null,"Portable Network Graphics & Steganography"),l.a.createElement("div",{className:"subtitle"},"Hiding and retrieving secret files inside PNG files")))}var u=a(8),o=a(9),m=a(10),d=a(11),p=a(4),f=a.n(p),E=a(7);function v(e){var t=l.a.useState(h),a=Object(c.a)(t,2),n=a[0],i=a[1],r=l.a.useState(h),s=Object(c.a)(r,2),u=s[0],o=s[1],m=l.a.useState(null),d=Object(c.a)(m,2),p=d[0],v=d[1],w=l.a.useState(!1),N=Object(c.a)(w,2),y=N[0],O=N[1],T=l.a.useRef(null),I=function(){var t=Object(E.a)(f.a.mark((function t(){var a,n,l;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(O(!0),!(null===(a=T.current)||void 0===a||null===(n=a.files)||void 0===n?void 0:n.length)){t.next=13;break}return t.t0=e,t.t1=Uint8Array,t.next=6,T.current.files[0].arrayBuffer();case 6:t.t2=t.sent,t.t3=new t.t1(t.t2),t.t0.setInputImage.call(t.t0,t.t3),v(null),l=URL.createObjectURL(T.current.files[0]),i(l),o(l);case 13:O(!1);case 14:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),S=null==u||""===u;return l.a.createElement("div",{className:"config input-file"},l.a.createElement("div",{className:"title"},"Input image"),l.a.createElement("div",{className:"subtitle"},"The input file must be a PNG image, you can either load from the file system or from an external URL. This is the image in which the secret is hidden or the secret will be hidden (depending on the mode)."),l.a.createElement("div",{className:"load-url-input"},l.a.createElement("input",{type:"text",value:u,onChange:function(t){""===t.target.value&&(i(""),e.setInputImage(null)),o(t.target.value)},name:"url",placeholder:"Insert png url here"}),l.a.createElement("button",{onClick:function(){O(!0),fetch(u,{method:"GET"}).then((function(e){if(200!==e.status)throw new b("Request response was not ok:\n\t'".concat(e.statusText));var t=e.headers.get("content-type")||"";if(!t.toLocaleLowerCase().includes("png"))throw new g('Input file must be a png image!\n\tType "'.concat(t,'" is not "image/png"'));return e})).then((function(e){return e.arrayBuffer()})).then((function(t){v(null),i(u),e.setInputImage(new Uint8Array(t))})).catch((function(t){v(t.toString()),i(u),e.setInputImage(null)})).finally((function(){O(!1)}))},disabled:S},"Load")),l.a.createElement("div",{className:"preview-img ".concat(e.empty?"empty":"")},l.a.createElement("figure",null,S||null==n||""===n?l.a.createElement("div",{className:"empty"},l.a.createElement("b",null,"EMPTY PREVIEW -- NO IMAGE!")):p?l.a.createElement("div",{className:"err"},l.a.createElement("span",null,p)):y?l.a.createElement("div",{className:"loading"},"Loading..."):l.a.createElement("img",{src:n,alt:"Input preview"}))),l.a.createElement("div",{className:"load-file"},l.a.createElement("label",{htmlFor:"file-upload-input-file",className:"btn"},"Or Load From File"),l.a.createElement("input",{id:"file-upload-input-file",type:"file",accept:".png",onChange:I,ref:T})))}var h=null!==""?"":"https://vignette.wikia.nocookie.net/anicrossbr/images/2/20/109_-_Neferpitou_portrait.png/revision/latest/scale-to-width-down/340?cb=20160308215759&path-prefix=pt-br",b=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(e){return Object(u.a)(this,a),t.call(this,"Failed to load image:\n\t"+e)}return a}(Object(d.a)(Error)),g=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(e){return Object(u.a)(this,a),t.call(this,"File type not supported:\n\t"+e)}return a}(Object(d.a)(Error));function w(e){return l.a.createElement("div",{className:"config mode"},l.a.createElement("div",{className:"title"},"Mode"),l.a.createElement("div",{className:"subtitle"},"You can either search for a secret hidden inside the input image or hide a new secret inside the input image."),l.a.createElement("div",{className:"opts"},l.a.createElement("label",{htmlFor:"hide"},l.a.createElement("input",{type:"radio",name:"mode",value:"hide",id:"hide",defaultChecked:!0,onClick:function(){return e.setMode("HIDE")}}),"Hide secret"),l.a.createElement("label",{htmlFor:"find"},l.a.createElement("input",{type:"radio",name:"mode",value:"find",id:"find",onClick:function(){return e.setMode("FIND")}}),"Find secret")))}function N(e){var t=e.secret,a=e.setSecret,n=e.empty,i=l.a.useRef(null),r="string"!==typeof t&&null!=(null===t||void 0===t?void 0:t.byteLength),c=r?t.slice(0,100).join(" ")+"...":t||"";return l.a.createElement("div",{className:"config secret"},l.a.createElement("div",{className:"title"},"Secret to be hidden"),l.a.createElement("div",{className:"subtitle"},"The secret can be a plain text message or a file loaded from the file system.",l.a.createElement("br",null),"Plain text messages where the first line is ",l.a.createElement("b",null,"#!HTML")," will be rendered as HTML."),l.a.createElement("div",{className:"plain-text"},l.a.createElement("textarea",{className:!n||null!=t&&""!==t?"":"empty",placeholder:"Type here the secret message to hide inside the input image",value:c.toString(),readOnly:r,disabled:r,title:r?"You cannot edit content loaded directly from a file!":"",onChange:function(e){return a(e.target.value)}}),l.a.createElement("div",{className:"footer"},l.a.createElement("div",{className:"clear-all"},l.a.createElement("button",{onClick:function(){return a(null)}},"Clear")),l.a.createElement("div",{className:"info"},"Data Length: ",r?t.length:c.length))),l.a.createElement("div",{className:"load-file"},l.a.createElement("label",{htmlFor:"file-upload-secret",className:"btn"},"Or Load From File"),l.a.createElement("input",{id:"file-upload-secret",type:"file",accept:"*",ref:i,onChange:Object(E.a)(f.a.mark((function e(){var t,n,l,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=i.current)||void 0===t||null===(n=t.files)||void 0===n?void 0:n.length)){e.next=11;break}return e.t0=Uint8Array,e.next=4,i.current.files[0].arrayBuffer();case 4:e.t1=e.sent,l=new e.t0(e.t1),r=i.current.files[0].name.includes(".")&&i.current.files[0].name.split(".").pop(),l.type=i.current.files[0].type+(r?"."+r:""),a(l),e.next=12;break;case 11:a(null);case 12:case"end":return e.stop()}}),e)})))})))}function y(e){return l.a.createElement("div",{className:"config bit-loss"},l.a.createElement("div",{className:"title"},"Bit Loss"),l.a.createElement("div",{className:"subtitle"},"Given one byte of the input image, how many bits, of this byte, we should dedicate to the secret ?",l.a.createElement("br",null),"Eg: Using bitloss = 4; Would take 2 bytes of the input image to encode 1 byte of the secret."),l.a.createElement("div",{className:"bit-loss-input"},l.a.createElement("select",{name:"bitloss",defaultValue:"8",onChange:function(t){e.setBitLoss(parseInt(t.target.value))}},l.a.createElement("option",{value:"1"},"1 bit"),l.a.createElement("option",{value:"2"},"2 bits"),l.a.createElement("option",{value:"4"},"4 bits"),l.a.createElement("option",{value:"6"},"6 bits"),l.a.createElement("option",{value:"8"},"8 bits"))))}a(22);function O(e){var t=l.a.useState(!1),a=Object(c.a)(t,2),n=a[0],i=a[1];return l.a.createElement("div",{className:"config-section"},l.a.createElement("div",{className:"main-title"},l.a.createElement("div",{className:"title"},"Configuration"),l.a.createElement("div",{className:"subtitle"},"Here you can specify which parameters to apply during the proccess, such as the input image, mode (hide secret or reveal secret), bit loss and the secret to be hidden.")),l.a.createElement(v,{setInputImage:e.actions.setInputImage,empty:n&&null===e.state.imageBuf}),l.a.createElement(w,{setMode:e.actions.setMode}),"FIND"!==e.state.mode&&l.a.createElement(l.a.Fragment,null,l.a.createElement(N,{setSecret:e.actions.setDataToHide,secret:e.state.dataToHide,empty:n}),l.a.createElement(y,{setBitLoss:e.actions.setBitLoss})),l.a.createElement("div",{className:"submit-section"},l.a.createElement("button",{className:"btn",onClick:function(){return null==e.state.imageBuf?i(!0):"HIDE"!==e.state.mode||null!=e.state.dataToHide&&""!==e.state.dataToHide?(i(!1),void e.actions.startProcess()):i(!0)}},"GO!"),n&&l.a.createElement("span",{className:"subtitle"},"Pleae fill in all the required fields! ")))}function T(e){e.mode;var t=e.output;return t.err||t.loading||!t.result?"EMPTY":t.loading?"LOADING":t.err?"ERR":null}var I=function(e){if(T(e))return null;var t="HEX"===e.output.viewType,a="FIND"===e.mode;return l.a.createElement("button",{className:"btn ".concat(t?"selected":""," ").concat(a?"":"disabled"),disabled:!a,onClick:function(){return e.setOutputView("HEX")}},"Show as Hex")},S=function(e){if(T(e)||"HEX"!==e.output.viewType)return null;var t=Array.from(e.output.result).map((function(e){return e.toString(16)})).join(" ");return l.a.createElement("div",{className:"output-type hex",style:{position:"absolute"}},l.a.createElement("pre",null,t))},j=function(e){if(T(e))return null;var t="PLAIN"===e.output.viewType,a="FIND"===e.mode;return l.a.createElement("button",{className:"btn ".concat(t?"selected":""," ").concat(a?"":"disabled"),disabled:!a,onClick:function(){return e.setOutputView("PLAIN")}},"Show as Plain Text")},P=function(e){if(T(e)||"PLAIN"!==e.output.viewType)return null;var t=(new TextDecoder).decode(e.output.result);return l.a.createElement("div",{className:"output-type plain-text"},t.startsWith("#!HTML")?l.a.createElement("div",{dangerouslySetInnerHTML:{__html:t}}):l.a.createElement("pre",null,t))},H={Button:function(e){if(T(e))return null;var t="PNG"===e.output.viewType,a=H.isPng(e.output.result)&&("FIND"===e.mode||"HIDE"===e.mode);return l.a.createElement("button",{className:"btn ".concat(t?"selected":""," ").concat(a?"":"disabled"),disabled:!a,onClick:function(){return e.setOutputView("PNG")}},"Show as PNG")},OutputView:function(e){var t=T(e)||"PNG"!==e.output.viewType,a=l.a.useMemo((function(){if(t)return null;var a=new Blob([e.output.result],{type:"image/png"});return URL.createObjectURL(a)}),[t,e.mode,e.output.result]);return t||null===a?null:l.a.createElement("div",{className:"output-type png"},l.a.createElement("figure",null,l.a.createElement("img",{src:a,alt:"Output file"})))},isPng:function(e){var t=e.subarray(0,8),a=[137,80,78,71,13,10,26,10];return t.every((function(e,t){return e===a[t]}))}},L=function(e){if(T(e))return null;var t="PPNG"===e.output.viewType,a=H.isPng(e.output.result)&&("FIND"===e.mode||"HIDE"===e.mode);return l.a.createElement("button",{className:"btn ".concat(t?"selected":""," ").concat(a?"":"disabled"),disabled:!a,onClick:function(){return e.setOutputView("PPNG")}},"Show as Parsed PNG")},D=function(e){var t=T(e)||"PPNG"!==e.output.viewType,a=l.a.useState(""),n=Object(c.a)(a,2),i=n[0],r=n[1];return l.a.useEffect((function(){t||window.PNG.toString(e.output.result,(function(e,t){if(e)return console.error(e);r(t)}))}),[t]),t?null:l.a.createElement("div",{className:"output-type png-parsed"},l.a.createElement("pre",null,i))};a(23);function x(e){var t,a,n=e.state,i=n.mode,r=n.output;return l.a.createElement("div",{className:"output-section"},l.a.createElement("div",{className:"main-title"},l.a.createElement("div",{className:"title"},"Output"),l.a.createElement("div",{className:"subtitle"},"HIDE"===i&&l.a.createElement("span",null,"This is the resultant image with the secret hidden deep down in the pixels of each ",l.a.createElement("i",null,"scanline.")," Higher values for ",l.a.createElement("i",null,"bit loss "),"produces images with a high volume of noise."),"FIND"===i&&l.a.createElement("span",null,"This is what we found after looking for a hidden secret inside this image"))),l.a.createElement("div",{className:"result-file"},l.a.createElement("div",{className:"output"},l.a.createElement(k,e.state),l.a.createElement(C,e.state),l.a.createElement(S,e.state),l.a.createElement(P,e.state),l.a.createElement(H.OutputView,e.state),l.a.createElement(D,e.state)),l.a.createElement("div",{className:"info"},l.a.createElement("b",null,r.result&&"HIDE"===i&&l.a.createElement("span",null,"New Image Length: ",null===r||void 0===r||null===(t=r.result)||void 0===t?void 0:t.length," bytes;"),r.result&&"FIND"===i&&l.a.createElement("span",null,"Hidden Secret Length: ",null===r||void 0===r||null===(a=r.result)||void 0===a?void 0:a.length," bytes; Hidden Secret Type: ",null===r||void 0===r?void 0:r.dataType,";"))),l.a.createElement("div",{className:"view-options"},l.a.createElement(H.Button,Object.assign({},e.state,{setOutputView:e.actions.setOutputView})),l.a.createElement(L,Object.assign({},e.state,{setOutputView:e.actions.setOutputView})),l.a.createElement(j,Object.assign({},e.state,{setOutputView:e.actions.setOutputView})),l.a.createElement(I,Object.assign({},e.state,{setOutputView:e.actions.setOutputView})),!T(e.state)&&l.a.createElement("button",{className:"btn",onClick:function(){var e=document.createElement("a"),t=new Blob([r.result],{type:"application/octet-stream"});e.href=URL.createObjectURL(t),e.download="download-"+r.dataType,e.click()}},"Download Output"))))}var k=function(e){return"EMPTY"!==T(e)?null:l.a.createElement("div",{className:"output-type empty"},l.a.createElement("p",null,"Please, fill in the Configuration form."))},C=function(e){return"LOADING"!==T(e)?null:l.a.createElement("div",{className:"output-type loading"},l.a.createElement("h4",null,"Loading please wait..."))},_=a(1),G={imageBuf:null,mode:"HIDE",dataToHide:"",bitLoss:8,output:{viewType:"PNG",result:null,err:null,loading:!1}};function M(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IMAGE_BUFF":return Object(_.a)(Object(_.a)({},e),{},{imageBuf:t.data,output:Object(_.a)({},G.output)});case"SET_MODE":return Object(_.a)(Object(_.a)({},e),{},{mode:t.data});case"SET_DATA_TO_HIDE":return Object(_.a)(Object(_.a)({},e),{},{dataToHide:t.data});case"SET_BITLOSS":return Object(_.a)(Object(_.a)({},e),{},{bitLoss:t.data});case"SET_OUTPUT_VIEW_TYPE":return Object(_.a)(Object(_.a)({},e),{},{output:Object(_.a)(Object(_.a)({},e.output),{},{viewType:t.data})});case"PROCCESS":return Object(_.a)(Object(_.a)({},e),{},{output:Object(_.a)(Object(_.a)({},e.output),t.data)});default:return e}}function B(e){var t=Object(c.a)(e,2),a=t[0],n=t[1];return[a,{setInputImage:function(e){n({type:"SET_IMAGE_BUFF",data:e})},setMode:function(e){n({type:"SET_MODE",data:e})},setDataToHide:function(e){n({type:"SET_DATA_TO_HIDE",data:e})},setBitLoss:function(e){n({type:"SET_BITLOSS",data:e})},setOutputView:function(e){n({type:"SET_OUTPUT_VIEW_TYPE",data:e})},startProcess:function(){n({type:"PROCCESS",data:{result:null,err:null,loading:!0}});var e,t=function(e,t){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return F(e,t,l,a.mode,n)};if("HIDE"===a.mode){var l,i=null===(l=a.dataToHide)||void 0===l?void 0:l.type;"string"===typeof a.dataToHide&&(i=a.dataToHide.startsWith("#!HTML")?"text/html.html":"text/plain.txt"),console.time("[HideSecret Time]"),window.PNG.hideData(a.imageBuf,(e=a.dataToHide).buffer?e:(new TextEncoder).encode(e),i,a.bitLoss,t),console.timeEnd("[HideSecret Time]")}else console.time("[RevealSecret Time]"),window.PNG.revealData(a.imageBuf,t),console.timeEnd("[RevealSecret Time]");console.log("Move wasm/go function call to a webwoker"),matchMedia("screen and (max-width: 860px)").matches?setTimeout((function(){return window.scrollTo(0,document.body.scrollHeight)}),100):window.scrollTo(0,0)}}]}var F=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0;if(e)return alert(e),l({type:"PROCCESS",data:{result:null,err:e,loading:!1}});var i=a.search(/png/gi)>=0||"HIDE"===n,r=a.search(/text/gi)>=0;l({type:"PROCCESS",data:{result:t,err:null,loading:!1,viewType:i?"PNG":r?"PLAIN":"HEX",dataType:"HIDE"===n?"secret.png":a}})};var R=function(e){var t=l.a.useState(matchMedia(e).matches),a=Object(c.a)(t,2),n=a[0],i=a[1],r=l.a.useCallback((function(){i(matchMedia(e).matches)}),[e]);return l.a.useEffect((function(){return window.addEventListener("resize",r),function(){window.removeEventListener("resize",r)}}),[r]),n},A=function(){var e=B(l.a.useReducer(M,G)),t=Object(c.a)(e,2),a=t[0],n=t[1],i=!R("screen and (max-width: 860px)")||a.output.result;return l.a.createElement("div",{className:"App"},l.a.createElement(s,null),l.a.createElement("main",null,l.a.createElement("section",null,l.a.createElement(O,{state:a,actions:n})),i&&l.a.createElement("section",null,l.a.createElement(x,{state:a,actions:n}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[14,1,2]]]);
//# sourceMappingURL=main.e72bdff0.chunk.js.map