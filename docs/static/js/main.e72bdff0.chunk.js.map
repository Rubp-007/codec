{"version":3,"sources":["components/header/index.tsx","components/configuration/InputFile.tsx","components/configuration/Mode.tsx","components/configuration/Secret.tsx","components/configuration/BitLoss.tsx","components/configuration/index.tsx","components/output/output-types.tsx","components/output/index.tsx","duck/index.ts","App.tsx","serviceWorker.js","index.tsx"],"names":["Header","props","className","href","target","InputFile","React","useState","initialUrl","url","setUrl","stagedUrl","setStagedUrl","err","setErr","isLoading","setLoading","inputFile","useRef","onLoadFromFileSystem","a","current","files","length","Uint8Array","arrayBuffer","setInputImage","u","URL","createObjectURL","isEmpty","type","value","onChange","evt","name","placeholder","onClick","fetch","method","then","res","status","FailedToLoadImage","statusText","headers","get","toLocaleLowerCase","includes","FileTypeNotSupported","buff","catch","toString","finally","disabled","empty","src","alt","htmlFor","id","accept","ref","message","Error","Mode","defaultChecked","setMode","Secret","secret","setSecret","secretFile","isBuffer","byteLength","text","slice","join","readOnly","title","v","ext","split","pop","BitLoss","defaultValue","e","setBitLoss","parseInt","Configuration","formError","setFormError","actions","state","imageBuf","mode","Fragment","setDataToHide","dataToHide","startProcess","isInvalidState","output","loading","result","Hex","selected","viewType","available","setOutputView","Array","from","map","item","style","position","Text","TextDecoder","decode","startsWith","dangerouslySetInnerHTML","__html","PNG","Button","isPng","OutputView","hide","imageUrl","useMemo","blob","Blob","subarray","b","every","i","PPNG","invalid","setText","useEffect","window","str","console","error","Output","dataType","document","createElement","download","click","Empty","Loading","initialState","bitLoss","reducer","action","data","makeActions","dispatch","buf","veiwType","raw","myHandle","handle","time","hideData","buffer","TextEncoder","encode","timeEnd","revealData","log","matchMedia","matches","setTimeout","scrollTo","body","scrollHeight","alert","search","isText","useMatchMedia","setMatches","fn","useCallback","addEventListener","removeEventListener","App","useReducer","showOutput","Boolean","location","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.e72bdff0.chunk.js","sourcesContent":["import React from 'react';\r\nimport './style.scss';\r\n\r\nexport default function Header(props: any) {\r\n\r\n    return (\r\n        <header className=\"app-header\">\r\n            <div className=\"icons\">\r\n                <div className=\"icon github\">\r\n                    <a href=\"https://github.com/pedrooaugusto/steganography-png\" target=\"_blank\">\r\n                        <i className=\"fa fa-github\" /> Github\r\n                    </a>\r\n                </div>\r\n                <div className=\"icon medium\">\r\n                    <a href=\"#dois\">\r\n                        <i className=\"fa fa-medium\" /> Article\r\n                    </a>\r\n                </div>\r\n            </div>\r\n            <div className=\"main-title\">\r\n                <h1>Portable Network Graphics & Steganography</h1>\r\n                <div className=\"subtitle\">Hiding and retrieving secret files inside PNG files</div>\r\n            </div>\r\n        </header>\r\n    )\r\n}","import React from 'react';\r\n\r\ntype InputFileProps = {\r\n    setInputImage: (input: Uint8Array | null) => void,\r\n    empty: boolean\r\n}\r\n\r\nexport default function InputFile(props: InputFileProps) {\r\n    const [url, setUrl] = React.useState(initialUrl);\r\n    const [stagedUrl, setStagedUrl] = React.useState(initialUrl);\r\n\r\n    const [err, setErr] = React.useState<string | null>(null);\r\n    const [isLoading, setLoading] = React.useState(false);\r\n    const inputFile = React.useRef<HTMLInputElement | null>(null);\r\n\r\n    const onLoadFromFileSystem = async function () {\r\n        setLoading(true);\r\n\r\n        if (inputFile.current?.files?.length) {\r\n            props.setInputImage(new Uint8Array(await inputFile.current.files[0].arrayBuffer()));\r\n            setErr(null);\r\n\r\n            const u = URL.createObjectURL(inputFile.current.files[0]);\r\n\r\n            setUrl(u);\r\n            setStagedUrl(u);\r\n        }\r\n\r\n        setLoading(false);\r\n    }\r\n\r\n    const onLoadFromUrl = () => {\r\n        setLoading(true);\r\n\r\n        fetch(stagedUrl, { method: 'GET' })\r\n            .then(res => {\r\n                if (res.status !== 200) throw new FailedToLoadImage(`Request response was not ok:\\n\\t'${res.statusText}`);\r\n\r\n                const type = res.headers.get('content-type') || '';\r\n\r\n                if (!type.toLocaleLowerCase().includes('png'))\r\n                    throw new FileTypeNotSupported(`Input file must be a png image!\\n\\tType \"${type}\" is not \"image/png\"`);\r\n\r\n                return res;\r\n            })\r\n            .then((res: any) => res.arrayBuffer())\r\n            .then((buff: ArrayBuffer) => {\r\n                setErr(null);\r\n                setUrl(stagedUrl);\r\n                props.setInputImage(new Uint8Array(buff));\r\n            })\r\n            .catch((err: Error) => {\r\n                setErr(err.toString());\r\n                setUrl(stagedUrl);\r\n                props.setInputImage(null);\r\n            }).finally(() => {\r\n                setLoading(false);\r\n            });\r\n    }\r\n\r\n    const isEmpty = (stagedUrl == null || stagedUrl === '')\r\n\r\n    return (\r\n        <div className=\"config input-file\">\r\n            <div className=\"title\">Input image</div>\r\n            <div className=\"subtitle\">\r\n                The input file must be a PNG image, you can either load from the file system\r\n                or from an external URL. This is the image in which the secret is hidden or\r\n                the secret will be hidden (depending on the mode).\r\n            </div>\r\n            <div className=\"load-url-input\">\r\n                <input\r\n                    type=\"text\"\r\n                    value={stagedUrl}\r\n                    onChange={evt => {\r\n                        if (evt.target.value === '') {\r\n                            setUrl('')\r\n                            props.setInputImage(null)\r\n                        }\r\n                        setStagedUrl(evt.target.value)\r\n                    }}\r\n                    name=\"url\"\r\n                    placeholder=\"Insert png url here\"\r\n                />\r\n                <button onClick={onLoadFromUrl} disabled={isEmpty}>Load</button>\r\n            </div>\r\n            <div className={`preview-img ${(props.empty) ? 'empty' : ''}`}>\r\n                <figure>\r\n                    {/* Ugly! */}\r\n                    {(() => {\r\n                        if (isEmpty || url == null || url === '') return <div className=\"empty\"><b>EMPTY PREVIEW -- NO IMAGE!</b></div>\r\n                        if (err) return <div className=\"err\"><span>{err}</span></div>\r\n                        if (isLoading) return <div className=\"loading\">Loading...</div>\r\n\r\n                        return <img src={url} alt=\"Input preview\" />\r\n                    })()}\r\n                </figure>\r\n            </div>\r\n            <div className=\"load-file\">\r\n                <label htmlFor=\"file-upload-input-file\" className=\"btn\">\r\n                    Or Load From File\r\n                </label>\r\n                <input\r\n                    id=\"file-upload-input-file\"\r\n                    type=\"file\"\r\n                    accept=\".png\"\r\n                    onChange={onLoadFromFileSystem}\r\n                    ref={inputFile}\r\n                />\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst initialUrl = '' ?? 'https://vignette.wikia.nocookie.net/anicrossbr/images/2/20/109_-_Neferpitou_portrait.png/revision/latest/scale-to-width-down/340?cb=20160308215759&path-prefix=pt-br';\r\n\r\ntype Error = {\r\n    message: string\r\n};\r\n\r\nclass FailedToLoadImage extends Error {\r\n    constructor(message: string){\r\n        super('Failed to load image:\\n\\t' + message);\r\n    }\r\n}\r\n\r\nclass FileTypeNotSupported extends Error {\r\n    constructor(message: string){\r\n        super('File type not supported:\\n\\t' + message);\r\n    }\r\n}","import React from 'react';\r\n\r\nexport default function Mode(props: { setMode: (mode: 'HIDE' | 'FIND') => void }) {\r\n    return (\r\n        <div className=\"config mode\">\r\n            <div className=\"title\">Mode</div>\r\n            <div className=\"subtitle\">\r\n                You can either search for a secret hidden inside the input image or hide a new\r\n                secret inside the input image.\r\n            </div>\r\n            <div className=\"opts\">\r\n                <label htmlFor=\"hide\">\r\n                    <input\r\n                        type=\"radio\"\r\n                        name=\"mode\"\r\n                        value=\"hide\"\r\n                        id=\"hide\"\r\n                        defaultChecked\r\n                        onClick={() => props.setMode('HIDE')}\r\n                    />\r\n                    Hide secret\r\n                </label>\r\n                <label htmlFor=\"find\">\r\n                    <input\r\n                        type=\"radio\"\r\n                        name=\"mode\"\r\n                        value=\"find\"\r\n                        id=\"find\"\r\n                        onClick={() => props.setMode('FIND')}\r\n                    />\r\n                    Find secret\r\n                </label>\r\n            </div>\r\n        </div>\r\n    )\r\n}","import React from 'react';\r\n\r\ntype Props = {\r\n    setSecret: (data: Uint8Array | null | string) => void,\r\n    secret: string | Uint8Array | null | undefined,\r\n    empty: boolean\r\n}\r\n\r\nexport default function Secret({ secret, setSecret, empty }: Props) {\r\n    const secretFile = React.useRef<HTMLInputElement | null>(null);\r\n    const isBuffer = typeof secret !== 'string' && secret?.byteLength != null\r\n    const text = isBuffer\r\n        ? (secret as Uint8Array).slice(0, 100).join(' ') + '...'\r\n        : !!secret ? secret : ''\r\n\r\n    return (\r\n        <div className=\"config secret\">\r\n            <div className=\"title\">Secret to be hidden</div>\r\n            <div className=\"subtitle\">\r\n                The secret can be a plain text message or a file loaded from the file system.<br/>\r\n                Plain text messages where the first line is <b>#!HTML</b> will be rendered as HTML.\r\n            </div>\r\n            <div className=\"plain-text\">\r\n                <textarea\r\n                    className={(empty && (secret == null || secret === '')) ? 'empty' : ''}\r\n                    placeholder=\"Type here the secret message to hide inside the input image\"\r\n                    value={text.toString()}\r\n                    readOnly={isBuffer}\r\n                    disabled={isBuffer}\r\n                    title={isBuffer ? 'You cannot edit content loaded directly from a file!' : ''}\r\n                    onChange={(evt) => setSecret(evt.target.value)}\r\n                ></textarea>\r\n                <div className=\"footer\">\r\n                    <div className=\"clear-all\">\r\n                        <button onClick={() => setSecret(null)}>Clear</button>\r\n                    </div>\r\n                    <div className=\"info\">\r\n                        Data Length: {isBuffer ? (secret as Uint8Array).length : text.length}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"load-file\">\r\n                <label htmlFor=\"file-upload-secret\" className=\"btn\">\r\n                    Or Load From File\r\n                </label>\r\n                <input\r\n                    id=\"file-upload-secret\"\r\n                    type=\"file\"\r\n                    accept=\"*\"\r\n                    ref={secretFile}\r\n                    onChange={async function(this: HTMLInputElement) {\r\n                        if (secretFile.current?.files?.length) {\r\n                            const v = new Uint8Array(await secretFile.current.files[0].arrayBuffer())\r\n\r\n                            const ext = secretFile.current.files[0].name.includes('.') && secretFile.current.files[0].name.split('.').pop()\r\n\r\n                            // @ts-ignore\r\n                            v.type = secretFile.current.files[0].type + (ext ? '.' + ext : '')\r\n\r\n                            setSecret(v);\r\n                        } else {\r\n                            setSecret(null);\r\n                        }\r\n                    }}\r\n                />\r\n            </div>\r\n        </div>\r\n    )\r\n}","import React from 'react';\r\n\r\nexport default function BitLoss(props: { setBitLoss: Function }) {\r\n    return (\r\n        <div className=\"config bit-loss\">\r\n            <div className=\"title\">Bit Loss</div>\r\n            <div className=\"subtitle\">\r\n                Given one byte of the input image, how many bits, of this byte, we should dedicate\r\n                to the secret ?<br/>\r\n                Eg: Using bitloss = 4; Would take 2 bytes of the input image to encode 1 byte of the secret.\r\n            </div>\r\n            <div className=\"bit-loss-input\">\r\n                <select\r\n                    name=\"bitloss\"\r\n                    defaultValue=\"8\"\r\n                    onChange={e => {\r\n                        props.setBitLoss(parseInt(e.target.value))\r\n                    }\r\n                }>\r\n\r\n                    <option value=\"1\">1 bit</option>\r\n                    <option value=\"2\">2 bits</option>\r\n                    <option value=\"4\">4 bits</option>\r\n                    <option value=\"6\">6 bits</option>\r\n                    <option value=\"8\">8 bits</option>\r\n                </select>\r\n            </div>\r\n        </div>\r\n    )\r\n}","import React from 'react';\r\nimport InputFile from './InputFile';\r\nimport Mode from './Mode';\r\nimport Secret from './Secret';\r\nimport BitLoss from './BitLoss';\r\nimport { Actions, State } from '../../duck';\r\nimport './style.scss';\r\n\r\ntype Props = {\r\n    state: State,\r\n    actions: Actions\r\n};\r\n\r\nexport default function Configuration(props: Props) {\r\n    const [formError, setFormError] = React.useState(false)\r\n\r\n    const startProcess = () => {\r\n        if(props.state.imageBuf == null) return setFormError(true)\r\n\r\n        if(props.state.mode === 'HIDE' && (props.state.dataToHide == null || props.state.dataToHide === '' )) {\r\n            return setFormError(true)\r\n        }\r\n\r\n        setFormError(false)\r\n\r\n        props.actions.startProcess()\r\n    }\r\n\r\n    return (\r\n        <div className=\"config-section\">\r\n            <div className=\"main-title\">\r\n                <div className=\"title\">Configuration</div>\r\n                <div className=\"subtitle\">\r\n                    Here you can specify which parameters to apply during the proccess, such as\r\n                    the input image, mode (hide secret or reveal secret), bit loss and the secret to be hidden.\r\n                </div>\r\n            </div>\r\n            <InputFile setInputImage={props.actions.setInputImage} empty={formError && props.state.imageBuf === null} />\r\n            <Mode setMode={props.actions.setMode} />\r\n            {props.state.mode !== 'FIND' && (\r\n                <React.Fragment>\r\n                    <Secret\r\n                        setSecret={props.actions.setDataToHide}\r\n                        secret={props.state.dataToHide}\r\n                        empty={formError}\r\n                    />\r\n                    <BitLoss setBitLoss={props.actions.setBitLoss} />\r\n                </React.Fragment>\r\n            )}\r\n            <div className=\"submit-section\">\r\n                <button\r\n                    className={`btn`}\r\n                    onClick={startProcess}\r\n                >\r\n                    GO!\r\n                </button>\r\n                {formError && (\r\n                    <span className=\"subtitle\">Pleae fill in all the required fields! </span>\r\n                )}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","import React from 'react'\r\nimport { State } from '../../duck'\r\n\r\nexport function isInvalidState (state: State): 'ERR' | 'LOADING' | 'EMPTY' | null {\r\n    const {mode, output} = state\r\n\r\n    const thereIsOutput = (!output.err && !output.loading && output.result)\r\n\r\n    if (!thereIsOutput) return 'EMPTY'\r\n\r\n    const isLoading = !!output.loading\r\n\r\n    if (isLoading) return 'LOADING'\r\n\r\n    const err = output.err\r\n\r\n    if (err) return 'ERR'\r\n\r\n    return null\r\n}\r\n\r\ninterface OutputMode {\r\n    Button: (props: State & { setOutputView: (type: 'PNG' | 'HEX' | 'PPNG' | 'PLAIN') => void }) => JSX.Element | null\r\n    OutputView: (props: State) => JSX.Element | null\r\n}\r\n\r\nexport const Hex: OutputMode = {\r\n    Button: (props) => {\r\n        if (isInvalidState(props)) return null\r\n        const selected = props.output.viewType === 'HEX'\r\n        const available = props.mode === 'FIND'\r\n\r\n        return (\r\n            <button\r\n                className={`btn ${selected ? 'selected' : ''} ${available ? '' : 'disabled'}`}\r\n                disabled={!available}\r\n                onClick={() => props.setOutputView('HEX')}\r\n            >\r\n                Show as Hex\r\n            </button>\r\n        )\r\n    },\r\n    OutputView: (props) => {\r\n        if (isInvalidState(props) || props.output.viewType !== 'HEX') return null\r\n\r\n        const text = Array.from((props.output.result as Uint8Array)).map(item => item.toString(16)).join(\" \")\r\n\r\n        return (\r\n            <div className=\"output-type hex\" style={{ position: 'absolute' }}>\r\n                <pre>{text}</pre>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport const Text: OutputMode = {\r\n    Button: (props) => {\r\n        if (isInvalidState(props)) return null\r\n        const selected = props.output.viewType === 'PLAIN'\r\n        const available = props.mode === 'FIND'\r\n\r\n        return (\r\n            <button\r\n                className={`btn ${selected ? 'selected' : ''} ${available ? '' : 'disabled'}`}\r\n                disabled={!available}\r\n                onClick={() => props.setOutputView('PLAIN')}\r\n            >\r\n                Show as Plain Text\r\n            </button>\r\n        )\r\n    },\r\n    OutputView: (props) => {\r\n        if (isInvalidState(props) || props.output.viewType !== 'PLAIN') return null\r\n\r\n        const text = new TextDecoder().decode((props.output.result as Uint8Array))\r\n\r\n        return (\r\n            <div className=\"output-type plain-text\">\r\n                {text.startsWith(\"#!HTML\") ? <div dangerouslySetInnerHTML={{ __html: text }} /> : <pre>{text}</pre>}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport const PNG: OutputMode & { isPng: Function } = {\r\n    Button: (props) => {\r\n        if (isInvalidState(props)) return null\r\n        const selected = props.output.viewType === 'PNG'\r\n        const available = PNG.isPng(props.output.result) && (props.mode === 'FIND' || props.mode === 'HIDE')\r\n\r\n        return (\r\n            <button\r\n                className={`btn ${selected ? 'selected' : ''} ${available ? '' : 'disabled'}`}\r\n                disabled={!available}\r\n                onClick={() => props.setOutputView('PNG')}\r\n            >\r\n                Show as PNG\r\n            </button>\r\n        )\r\n    },\r\n    OutputView: (props) => {\r\n        const hide = isInvalidState(props) || props.output.viewType !== 'PNG'\r\n\r\n        const imageUrl = React.useMemo(() => {\r\n            if (hide) return null\r\n\r\n            const blob = new Blob([props.output.result as Uint8Array], { type: \"image/png\" })\r\n\r\n            return URL.createObjectURL(blob)\r\n    \r\n        }, [hide, props.mode, props.output.result])\r\n\r\n        if (hide || imageUrl === null) return null\r\n\r\n        return (\r\n            <div className=\"output-type png\">\r\n                <figure>\r\n                    <img src={imageUrl} alt=\"Output file\" />\r\n                </figure>\r\n            </div>\r\n        )\r\n    },\r\n    isPng: (result: Uint8Array) => {\r\n        const a = result.subarray(0, 8)\r\n        const b = [137, 80, 78, 71, 13, 10, 26, 10]\r\n\r\n        return a.every((v, i) => v === b[i])\r\n    }\r\n}\r\n\r\n// Parsed PNG view\r\nexport const PPNG: OutputMode = {\r\n    Button: (props) => {\r\n        if (isInvalidState(props)) return null\r\n        const selected = props.output.viewType === 'PPNG'\r\n        const available = PNG.isPng(props.output.result) && (props.mode === 'FIND' || props.mode === 'HIDE')\r\n\r\n        return (\r\n            <button\r\n                className={`btn ${selected ? 'selected' : ''} ${available ? '' : 'disabled'}`}\r\n                disabled={!available}\r\n                onClick={() => props.setOutputView('PPNG')}\r\n            >\r\n                Show as Parsed PNG\r\n            </button>\r\n        )\r\n    },\r\n    OutputView: (props) => {\r\n        const invalid = isInvalidState(props) || props.output.viewType !== 'PPNG'\r\n        const [text, setText] = React.useState('')\r\n\r\n        // Please, dont do it here. Move it to somewhere else later.\r\n        React.useEffect(() => {\r\n            if (!invalid) {\r\n                window.PNG.toString(props.output.result as Uint8Array, (err, str) => {\r\n                    if (err) return console.error(err)\r\n\r\n                    setText(str)\r\n                })\r\n            }\r\n\r\n        }, [invalid])\r\n\r\n        if (invalid) return null\r\n\r\n        return (\r\n            <div className=\"output-type png-parsed\">\r\n                <pre>{text}</pre>\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react'\r\nimport { Actions, State } from '../../duck'\r\nimport { Hex, Text, isInvalidState, PNG, PPNG } from './output-types'\r\nimport './style.scss'\r\n\r\ntype Props = {\r\n    state: State,\r\n    actions: Actions\r\n}\r\n\r\nexport default function Output(props: Props) {\r\n    const { state: { mode, output } } = props\r\n\r\n    const download = () => {\r\n        const a = document.createElement('a')\r\n        const blob = new Blob([output.result as Uint8Array], { type: 'application/octet-stream' })\r\n        a.href = URL.createObjectURL(blob)\r\n        a.download = 'download-' + output.dataType\r\n        a.click()\r\n    }\r\n\r\n    return (\r\n        <div className=\"output-section\">\r\n            <div className=\"main-title\">\r\n                <div className=\"title\">Output</div>\r\n                <div className=\"subtitle\">\r\n                    {mode === 'HIDE' && (\r\n                        <span>\r\n                            This is the resultant image with the secret hidden deep down\r\n                            in the pixels of each <i>scanline.</i> Higher values for <i>bit loss </i>\r\n                            produces images with a high volume of noise.\r\n                        </span>\r\n                    )}\r\n                    {mode === 'FIND' && (\r\n                        <span>\r\n                            This is what we found after looking for a hidden secret inside this image\r\n                        </span>\r\n                    )}\r\n                </div>\r\n            </div>\r\n            <div className=\"result-file\">\r\n                <div className=\"output\">\r\n                    <Empty {...props.state} />\r\n                    <Loading {...props.state} />\r\n                    <Hex.OutputView {...props.state} />\r\n                    <Text.OutputView {...props.state} />\r\n                    <PNG.OutputView {...props.state} />\r\n                    <PPNG.OutputView {...props.state} />\r\n                </div>\r\n                <div className=\"info\">\r\n                    <b>\r\n                    {output.result && mode === 'HIDE' && (<span>New Image Length: {output?.result?.length} bytes;</span>)}\r\n                    {output.result && mode === 'FIND' && (\r\n                        <span>\r\n                            Hidden Secret Length: {output?.result?.length} bytes;\r\n                            Hidden Secret Type: {output?.dataType};\r\n                        </span>\r\n                    )}\r\n                    </b>\r\n                </div>\r\n                <div className=\"view-options\">\r\n                    <PNG.Button {...props.state} setOutputView={props.actions.setOutputView} />\r\n                    <PPNG.Button {...props.state} setOutputView={props.actions.setOutputView} />\r\n                    <Text.Button {...props.state} setOutputView={props.actions.setOutputView} />\r\n                    <Hex.Button {...props.state} setOutputView={props.actions.setOutputView} />\r\n                    { !isInvalidState(props.state) && (\r\n                        <button className={`btn`} onClick={download}>\r\n                            Download Output\r\n                        </button>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst Empty = (props: State) => {\r\n    if (isInvalidState(props) !== 'EMPTY') return null\r\n\r\n    return (\r\n        <div className=\"output-type empty\">\r\n            <p>Please, fill in the Configuration form.</p>\r\n        </div>\r\n    )\r\n\r\n}\r\n\r\nconst Loading = (props: State) => {\r\n    if (isInvalidState(props) !== 'LOADING') return null\r\n\r\n    return (\r\n        <div className=\"output-type loading\">\r\n            <h4>Loading please wait...</h4>\r\n        </div>\r\n    )\r\n}","export type State = {\r\n    imageBuf: Uint8Array | null,\r\n    mode: 'HIDE' | 'FIND',\r\n    dataToHide?: Uint8Array | string | null,\r\n    bitLoss?: 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8,\r\n    output: {\r\n        viewType: 'PNG' | 'PPNG' | 'PLAIN' | 'HEX',\r\n        result: Uint8Array | null,\r\n        dataType?: string,\r\n        err: Error | null,\r\n        loading: boolean\r\n    }\r\n}\r\n\r\ntype Action = {\r\n    type: 'SET_IMAGE_BUFF' | 'SET_MODE' | 'SET_DATA_TO_HIDE' | 'SET_BITLOSS' |\r\n        'PROCCESS' | 'CHANGE_OUTPUT_VIEW_MODE' | 'SET_OUTPUT_VIEW_TYPE',\r\n    data: any\r\n}\r\n\r\nexport const initialState: State = {\r\n    imageBuf: null,\r\n    mode: 'HIDE',\r\n    dataToHide: '',\r\n    bitLoss: 8,\r\n    output: {\r\n        viewType: 'PNG',\r\n        result: null,\r\n        err: null,\r\n        loading: false\r\n    }\r\n}\r\n\r\nexport default function reducer(state = initialState, action: Action): State {\r\n    switch(action.type) {\r\n        case 'SET_IMAGE_BUFF':\r\n            return { ...state, imageBuf: action.data, output: { ...initialState.output } }\r\n        case 'SET_MODE':\r\n            return { ...state, mode: action.data }\r\n        case 'SET_DATA_TO_HIDE':\r\n            return { ...state, dataToHide: action.data }\r\n        case 'SET_BITLOSS':\r\n            return { ...state, bitLoss: action.data }\r\n        case 'SET_OUTPUT_VIEW_TYPE':\r\n            return { ...state, output: { ...state.output, viewType: action.data } }\r\n        case 'PROCCESS':\r\n            return { ...state, output: { ...state.output, ...action.data } }\r\n\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\nexport interface Actions {\r\n    setInputImage: (buf: Uint8Array | null) => void,\r\n    setMode: (mode: 'HIDE' | 'FIND') => void,\r\n    setDataToHide: (buf: Uint8Array | null | string) => void,\r\n    setBitLoss: (bitLoss: 2 | 4 | 6 | 8) => void,\r\n    setOutputView: (type: 'PNG' | 'PPNG' | 'PLAIN' | 'HEX') => void,\r\n    startProcess: () => void\r\n}\r\n\r\nexport function makeActions([state, dispatch]: [State, (action: Action) => void]): [State, Actions] {\r\n    return [state, {\r\n        setInputImage(buf: Uint8Array | null) {\r\n            dispatch({ type: 'SET_IMAGE_BUFF', data: buf })\r\n        },\r\n        setMode(mode: 'HIDE' | 'FIND') {\r\n            dispatch({ type: 'SET_MODE', data: mode })\r\n        },\r\n        setDataToHide(buf: Uint8Array | null | string) {\r\n            dispatch({ type: 'SET_DATA_TO_HIDE', data: buf })\r\n        },\r\n        setBitLoss(bitLoss: 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8) {\r\n            dispatch({ type: 'SET_BITLOSS', data: bitLoss })\r\n        },\r\n        setOutputView(veiwType) {\r\n            dispatch({ type: 'SET_OUTPUT_VIEW_TYPE', data: veiwType })\r\n        },\r\n        startProcess(){\r\n            dispatch({ type: 'PROCCESS', data: {\r\n                result: null,\r\n                err: null,\r\n                loading: true\r\n            }})\r\n\r\n            const myHandle = (err: null | Error, data: Uint8Array, dataType: string = \"\") => handle(err, data, dataType, state.mode, dispatch)\r\n\r\n            if (state.mode === 'HIDE') {\r\n                // @ts-ignore\r\n                let dataType = state.dataToHide?.type\r\n\r\n                if (typeof state.dataToHide === 'string') {\r\n                    dataType = state.dataToHide.startsWith(\"#!HTML\") ? 'text/html.html' : 'text/plain.txt'\r\n                }\r\n\r\n                console.time('[HideSecret Time]')\r\n                window.PNG.hideData(state.imageBuf!, toUint8Array(state.dataToHide), dataType, state.bitLoss, myHandle)\r\n                console.timeEnd('[HideSecret Time]')\r\n            } else {\r\n                console.time('[RevealSecret Time]')\r\n                window.PNG.revealData(state.imageBuf!, myHandle)\r\n                console.timeEnd('[RevealSecret Time]')\r\n            }\r\n\r\n            console.log('Move wasm/go function call to a webwoker')\r\n\r\n            if (matchMedia('screen and (max-width: 860px)').matches) setTimeout(() => window.scrollTo(0, document.body.scrollHeight), 100)\r\n            else window.scrollTo(0, 0)\r\n        }\r\n    }]\r\n}\r\n\r\nconst handle = (err: null | Error, data: Uint8Array, dataType: string = \"\", mode: string, dispatch: (action: Action) => void): void => {\r\n    if (err) {\r\n        alert(err)\r\n        return dispatch({\r\n            type: 'PROCCESS',\r\n            data: {\r\n                result: null,\r\n                err: err,\r\n                loading: false\r\n            }\r\n        })\r\n    }\r\n\r\n    // Force display as PNG if the mode is hide.\r\n    const isPng = dataType.search(/png/gi) >= 0 || mode === 'HIDE'\r\n    const isText = dataType.search(/text/gi) >= 0\r\n\r\n    dispatch({\r\n        type: 'PROCCESS',\r\n        data: {\r\n            result: data,\r\n            err: null,\r\n            loading: false,\r\n            viewType: isPng ? 'PNG' : isText ? 'PLAIN' : 'HEX',\r\n            dataType: mode === 'HIDE' ? 'secret.png' : dataType\r\n        }\r\n    })\r\n}\r\n\r\nfunction toUint8Array(raw: string | Uint8Array | undefined | null): Uint8Array {\r\n    if ((raw as Uint8Array).buffer) return (raw as Uint8Array)\r\n\r\n    return new TextEncoder().encode(raw as string)\r\n}","import React from 'react';\r\nimport Header from './components/header';\r\nimport Configuration from './components/configuration';\r\nimport Output from './components/output';\r\nimport reducer, { makeActions, initialState } from './duck';\r\nimport { match } from 'assert';\r\n\r\nfunction App() {\r\n\tconst [state, actions] = makeActions(React.useReducer(reducer, initialState));\r\n\tconst matches = useMatchMedia('screen and (max-width: 860px)');\r\n\r\n\tconst showOutput = !matches || (state.output.result);\r\n\r\n\treturn (\r\n\t\t<div className=\"App\">\r\n\t\t\t<Header />\r\n\t\t\t<main>\r\n\t\t\t\t<section>\r\n\t\t\t\t\t<Configuration state={state} actions={actions} />\r\n\t\t\t\t</section>\r\n\t\t\t\t{showOutput && (\r\n\t\t\t\t\t<section>\r\n\t\t\t\t\t\t<Output state={state} actions={actions} />\r\n\t\t\t\t\t</section>\r\n\t\t\t\t)}\r\n\t\t\t</main>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\n// We can move it to duck\r\nconst useMatchMedia = (str: string) => {\r\n\tconst [matches, setMatches]\t= React.useState(matchMedia(str).matches);\r\n\tconst fn = React.useCallback(() => {\r\n\t\tsetMatches(matchMedia(str).matches);\r\n\t}, [str]);\r\n\r\n\tReact.useEffect(() => {\r\n\t\twindow.addEventListener(\"resize\", fn);\r\n\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener(\"resize\", fn);\r\n\t\t}\r\n\t}, [fn])\r\n\r\n\treturn matches;\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\n\r\ndeclare global {\r\n  interface PNG {\r\n    hideData: (\r\n      input: Uint8Array,\r\n      dataToHide: Uint8Array,\r\n      type: string,\r\n      bitLoss: 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | undefined,\r\n      callback: (err: Error | null, data: Uint8Array, dataType?: string) => void\r\n    ) => void,\r\n    revealData: (\r\n      input: Uint8Array,\r\n      callback: (err: Error | null, data: Uint8Array, dataType?: string) => void\r\n    ) => void,\r\n    toString: (\r\n      input: Uint8Array,\r\n      callback: (err: Error, str: string) => void\r\n    ) => void\r\n  }\r\n\r\n  interface Window {\r\n    PNG: PNG\r\n  }\r\n}\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}